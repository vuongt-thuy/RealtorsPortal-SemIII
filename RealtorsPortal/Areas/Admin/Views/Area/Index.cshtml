
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

@section css {
    <link rel="stylesheet" href="~/Areas/Content/plugins/select2/css/select2.min.css">
}
@section title { Area Management}
@section section_title { Area Management }
@section breadcrumb { Area Management }

<div class="row">
    <div class="col-md-3">
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modelCountry" style="width: 200px;">
            <i class="fas fa-plus"></i>  Add New Country
        </button>
    </div>
    <div class="col-md-3">
        <button type="button" class="btn" data-toggle="modal" data-target="#modelCity" style="background:#6c757d; width: 200px; color: white;">
            <i class="fas fa-plus"></i>  Add New City
        </button>
    </div>
    <div class="col-md-3">
        <button type="button" class="btn" data-toggle="modal" data-target="#modelDistrict" style="background:#17a2b8; width: 200px; color: white;">
            <i class="fas fa-plus"></i>  Add New District
        </button>
    </div>
    <div class="col-md-3">
        <button type="button" class="btn" data-toggle="modal" data-target="#modelWard" style="background:#17a2b8; width: 200px; color: white;">
            <i class="fas fa-plus"></i>  Add New Ward
        </button>
    </div>
</div>
<div class="container" style="margin-top: 50px;">
    <form action="enhanced-results.html">
        <div class="row">
            <div class="col-md-10 offset-md-1">
                <div class="row">
                    <div class="col-4">
                        <div class="form-group">
                            <label>Result Type:</label>
                            <select class="select2" style="width: 100%;">
                                <option>Country</option>
                                <option>City</option>
                                <option>District</option>
                                <option>Wrad</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <label>Sort Order:</label>
                            <select class="select2" style="width: 100%;">
                                <option selected>ASC</option>
                                <option>DESC</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <label>Country:</label>
                            <select class="select2" style="width: 100%;">
                                <option selected>ASC</option>
                                <option>DESC</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <label>City:</label>
                            <select class="select2" style="width: 100%;">
                                <option selected>ASC</option>
                                <option>DESC</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <label>District:</label>
                            <select class="select2" style="width: 100%;">
                                <option selected>ASC</option>
                                <option>DESC</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <label>Keyword:</label>
                            <input type="search" class="form-control" placeholder="Type your keywords here">
                        </div>
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <button class="btn btn-lg btn-info">Search</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="row" style="margin-top: 30px;">
    <div class="col-md-12">

        <div class="card card-primary">
            <div class="card-header">
                <h3 class="card-title">Listing</h3>

                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>

            <div class="card-body" style="display: block;">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th style="width: 10px">#</th>
                            <th>Name</th>
                            <th>Code</th>
                            <th width="150">Status</th>
                            <th width="115"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1.</td>
                            <td>Viet Nam</td>
                            <td>
                                VN
                            </td>
                            <td></td>
                            <td>
                                <a href="#" class="btn btn-info"><i class="fas fa-edit"></i></a>
                                <a href="#" class="btn btn-danger"><i class="fas fa-trash"></i></a>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="clearfix" style="margin-top: 15px;">
                    <ul class="pagination pagination-sm m-0 float-right">
                        <li class="page-item"><a class="page-link" href="#">«</a></li>
                        <li class="page-item"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item"><a class="page-link" href="#">»</a></li>
                    </ul>
                </div>
            </div>
            <!-- /.card-body -->
        </div>
        <!-- /.card -->
    </div>
</div>
<div class="modal fade" id="modelCountry" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New Country</h5>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="inputName">Name</label>
                    <input type="text" class="form-control name-area" data-type="country" value="">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button"  class="btn btn-primary btn-add-new-area" data-type="country">Save</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modelCity" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New City</h5>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="inputName">Name</label>
                    <input type="text" class="form-control name-area" data-type="city" value="">
                </div>
                <div class="form-group">
                    <label>Country:</label>
                    <select class="select2 select-country" style="width: 100%;">
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary btn-add-new-area" data-type="city">Save</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modelDistrict" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New District</h5>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="inputName">Name</label>
                    <input type="text" class="form-control name-area" data-type="district" value="">
                </div>
                <div class="form-group">
                    <label>City:</label>
                    <select class="select2 select-city" style="width: 100%;">
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button"  class="btn btn-primary btn-add-new-area" data-type="district">Save</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modelWard" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New District</h5>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="inputName">Name</label>
                    <input type="text" class="form-control name-area" data-type="ward" value="">
                </div>
                <div class="form-group">
                    <label>District:</label>
                    <select class="select2 select-district" style="width: 100%;">
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button"  class="btn btn-primary btn-add-new-area" data-type="ward">Save</button>
            </div>
        </div>
    </div>
</div>
@section scripts {
    <script src="~/Areas/Content/plugins/select2/js/select2.full.min.js"></script>
    <script src="~/Scripts/toastr.min.js"></script>
    <script src="~/Areas/Content/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/Areas/Content/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/Areas/Content/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/Areas/Content/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
    <script src="~/Areas/Content/plugins/datatables-buttons/js/buttons.print.min.js"></script>
    <script src="~/Areas/Content/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
    <script src="~/Areas/Content/plugins/bootstrap-switch/js/bootstrap-switch.min.js"></script>
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>

    <script>
        $(function () {
            $('.select2').select2()
        });

        $('#modelCity').on('show.bs.modal', function (e) {
            return $.ajax({
                type: 'GET',
                contentType: 'application/json',
                url: '/Admin/Area/GetAllCountry',
                dataType: 'json',
                cache: false
            }).done(function (data) {
                data.forEach(function (item) {
                    $('.select-country').append("<option value='" + item.Id + "'>" + item.Name + "</option>")
                })
            });
        })

        $('#modelDistrict').on('show.bs.modal', function (e) {
            return $.ajax({
                type: 'GET',
                contentType: 'application/json',
                url: '/Admin/Area/GetAllCity',
                dataType: 'json',
                cache: false
            }).done(function (data) {
                data.forEach(function (item) {
                    $('.select-city').append("<option value='" + item.Id + "'>" + item.Name + "</option>")
                })
            });
        })

        $('#modelWard').on('show.bs.modal', function (e) {
            return $.ajax({
                type: 'GET',
                contentType: 'application/json',
                url: '/Admin/Area/GetAllDistrict',
                dataType: 'json',
                cache: false
            }).done(function (data) {
                data.forEach(function (item) {
                    $('.select-district').append("<option value='" + item.Id + "'>" + item.Name + "</option>")
                })
            });
        })

        $(document).on('click', '.btn-add-new-area', function () {
            let type = $(this).data('type');
            let name = $(`.name-area[data-type=${type}]`).val();
            let ajaxData = {
                Name: name
            };
            let ajaxUrl = "";

            if (type == 'country') {
                ajaxUrl = '/Admin/Area/CreateCountry';
            } else if (type == 'city') {
                ajaxUrl = '/Admin/Area/CreateCity';
                let countryId = $('.select-country').val();
                ajaxData.CountryId = countryId;
            } else if (type == 'district') {
                ajaxUrl = '/Admin/Area/CreateDistrict';
                let cityId = $('.select-city').val();
                ajaxData.CityId = cityId;
            } else if (type == 'ward') {
                ajaxUrl = '/Admin/Area/CreateDistrict';
                let districtId = $('.select-district').val();
                ajaxData.DistrictId = districtId;
            }

            $.ajax({
                type: "POST",
                url: ajaxUrl,
                data: ajaxData,
                success: function (res) {
                    if (res.statusCode == 200) {
                        console.log(res);
                    } else if (res.statusCode == 201) {
                        formValidate.showErrors(res.data)
                    }
                }
            })
        });
    </script>
}