@model IEnumerable<DataAccessLayer.Models.ViewModel.AdsViewModel>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@section css {
    <style>
        .custome-input-date input[type="date"] {
            border-radius: 0;
            border: 2px solid #ededed;
            height: 50px;
            line-height: 46px;
            min-width: 280px;
            margin-bottom: 0px;
        }

        #btnFilter-date {
            height: 50px;
            line-height: 17px;
            padding: 0px;
            width: 100%;
        }
    </style>
}

@section breadcrumb {
    <div class="ltn__breadcrumb-area text-left bg-overlay-white-30 bg-image " data-bg="img/bg/14.jpg">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ltn__breadcrumb-inner">
                        <h1 class="page-title">Real Estate Rental</h1>
                        <div class="ltn__breadcrumb-list">
                            <ul>
                                <li><a href="/"><span class="ltn__secondary-color"><i class="fas fa-home"></i></span> Home</a></li>
                                <li>Sell</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
<!-- PRODUCT DETAILS AREA START -->
<div class="ltn__product-area ltn__product-gutter">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 order-lg-2 mb-100">
                <div class="ltn__shop-options">
                    <ul class="justify-content-start">
                        <li>
                            <div class="ltn__grid-list-tab-menu ">
                                <div class="nav">
                                    <a class="active show" data-toggle="tab" href="#liton_product_grid"><i class="fas fa-th-large"></i></a>
                                    <a data-toggle="tab" href="#liton_product_list"><i class="fas fa-list"></i></a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="short-by text-center">
                                <select class="nice-select" id="filter-sort">
                                    <option value="sortByDefault">Default Sorting</option>
                                    <option value="sortByAlphabetAscending">Sort by title: A-Z</option>
                                    <option value="sortByAlphabetDecending">Sort by title: Z-A </option>
                                    <option value="sortByPriceAscending">Sort by price: low to high</option>
                                    <option value="sortByPriceDecending">Sort by price: high to low</option>
                                </select>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="ltn__shop-options">
                    <ul>
                        <li>
                            <div class="row">
                                <div class="col-5">
                                    <div class="custome-input-date">
                                        <input type="date" name="startDate" id="startDate" value="@String.Format("{0:yyyy-MM-dd}", @DateTime.Now)" />
                                    </div>
                                </div>
                                <div class="col-5">
                                    <div class="short-by text-center custome-input-date">
                                        <input type="date" name="endDate" id="endDate" value="@String.Format("{0:yyyy-MM-dd}", @DateTime.Now)" />
                                    </div>
                                </div>
                                <div class="col-2">
                                    <button class="btn theme-btn-1 btn-effect-1 text-uppercase" id="btnFilter-date" type="button">Filter</button>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="tab-content" id="content-data">
                </div>
            </div>
            <div class="col-lg-4  mb-100">
                <aside class="sidebar ltn__shop-sidebar">
                    <h3 class="mb-10">Advance Information</h3>
                    <label class="mb-30"><small id="result-total-ads"></small></label>
                    <!-- Advance Information widget -->
                    <div class="widget ltn__menu-widget">

                        @{
                            <h4 class="ltn__widget-title">Category</h4>

                            if (ViewBag.categories != null)
                            {
                                var categories = ViewBag.categories as IEnumerable<DataAccessLayer.Models.ViewModel.CategoryViewModel>;
                                <ul>
                                    @foreach (var item in categories)
                                    {
                                        <li>
                                            <label class="checkbox-item">
                                                @item.Name
                                                <input type="checkbox" class="filter-category" value="@item.Id">
                                                <span class="checkmark"></span>
                                            </label>
                                        </li>
                                    }
                                </ul>
                            }
                        }
                        <hr>
                        <h4 class="ltn__widget-title ltn__widget-title-border---">Filter by price</h4>
                        <ul>
                            <li>
                                <label class="checkbox-item">
                                    0-30,000 $
                                    <input type="checkbox" class="filter-price" value="0-30000">
                                    <span class="checkmark"></span>
                                </label>
                            </li>
                            <li>
                                <label class="checkbox-item">
                                    30.000-50.000 $
                                    <input type="checkbox" class="filter-price" value="30000-50000">
                                    <span class="checkmark"></span>
                                </label>
                            </li>
                            <li>
                                <label class="checkbox-item">
                                    50.000-80.000 $
                                    <input type="checkbox" class="filter-price" value="50000-80000">
                                    <span class="checkmark"></span>
                                </label>
                            </li>
                            <li>
                                <label class="checkbox-item">
                                    80.000-100.000 $
                                    <input type="checkbox" class="filter-price" value="80000-100000">
                                    <span class="checkmark"></span>
                                </label>
                            </li>
                            <li>
                                <label class="checkbox-item">
                                    100.000-130.000 $
                                    <input type="checkbox" class="filter-price" value="100000-130000">
                                    <span class="checkmark"></span>
                                </label>
                            </li>
                            <li>
                                <label class="checkbox-item">
                                    >= 130.000 $
                                    <input type="checkbox" class="filter-price" value="130000">
                                    <span class="checkmark"></span>
                                </label>
                            </li>
                        </ul>
                        <hr>

                        @if (ViewBag.countries != null)
                        {
                            <h4 class="ltn__widget-title">Country</h4>
                            <ul>
                                @{
                                    var countries = ViewBag.countries as IEnumerable<DataAccessLayer.Models.ViewModel.CountryViewModel>;
                                    foreach (var item in countries)
                                    {
                                        <li>
                                            <label class="checkbox-item">
                                                @item.Name
                                                <input type="checkbox" class="filter-country" value="@item.Id">
                                                <span class="checkmark"></span>
                                            </label>
                                        </li>
                                    }
                                }
                            </ul>
                        }
                    </div>
                    <!-- Category Widget -->
                    <div class="widget ltn__menu-widget d-none">
                        <h4 class="ltn__widget-title ltn__widget-title-border">Product categories</h4>
                        <ul>
                            <li><a href="#">Body <span><i class="fas fa-long-arrow-alt-right"></i></span></a></li>
                            <li><a href="#">Interior <span><i class="fas fa-long-arrow-alt-right"></i></span></a></li>
                            <li><a href="#">Lights <span><i class="fas fa-long-arrow-alt-right"></i></span></a></li>
                            <li><a href="#">Parts <span><i class="fas fa-long-arrow-alt-right"></i></span></a></li>
                            <li><a href="#">Tires <span><i class="fas fa-long-arrow-alt-right"></i></span></a></li>
                            <li><a href="#">Uncategorized <span><i class="fas fa-long-arrow-alt-right"></i></span></a></li>
                            <li><a href="#">Wheel <span><i class="fas fa-long-arrow-alt-right"></i></span></a></li>
                        </ul>
                    </div>
                    <!-- Price Filter Widget -->
                    <div class="widget ltn__price-filter-widget d-none">
                        <h4 class="ltn__widget-title ltn__widget-title-border">Filter by price </h4>
                        <div class="price_filter">
                            <div class="price_slider_amount">
                                <input type="submit" value="Your range:" />
                                <input type="text" class="amount" name="price" placeholder="Add Your Price" />
                            </div>
                            <div class="slider-range"></div>
                        </div>
                    </div>
                    <!-- Top Rated Product Widget -->
                    <div class="widget ltn__top-rated-product-widget d-none">
                        <h4 class="ltn__widget-title ltn__widget-title-border">Top Rated Product</h4>
                        <ul>
                            <li>
                                <div class="top-rated-product-item clearfix">
                                    <div class="top-rated-product-img">
                                        <a href="product-details.html"><img src="img/product/1.png" alt="#"></a>
                                    </div>
                                    <div class="top-rated-product-info">
                                        <div class="product-ratting">
                                            <ul>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                            </ul>
                                        </div>
                                        <h6><a href="product-details.html">Mixel Solid Seat Cover</a></h6>
                                        <div class="product-price">
                                            <span>$49.00</span>
                                            <del>$65.00</del>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="top-rated-product-item clearfix">
                                    <div class="top-rated-product-img">
                                        <a href="product-details.html"><img src="img/product/2.png" alt="#"></a>
                                    </div>
                                    <div class="top-rated-product-info">
                                        <div class="product-ratting">
                                            <ul>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                            </ul>
                                        </div>
                                        <h6><a href="product-details.html">Brake Conversion Kit</a></h6>
                                        <div class="product-price">
                                            <span>$49.00</span>
                                            <del>$65.00</del>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="top-rated-product-item clearfix">
                                    <div class="top-rated-product-img">
                                        <a href="product-details.html"><img src="img/product/3.png" alt="#"></a>
                                    </div>
                                    <div class="top-rated-product-info">
                                        <div class="product-ratting">
                                            <ul>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star"></i></a></li>
                                                <li><a href="#"><i class="fas fa-star-half-alt"></i></a></li>
                                                <li><a href="#"><i class="far fa-star"></i></a></li>
                                            </ul>
                                        </div>
                                        <h6><a href="product-details.html">Coil Spring Conversion</a></h6>
                                        <div class="product-price">
                                            <span>$49.00</span>
                                            <del>$65.00</del>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <!-- Tagcloud Widget -->
                    <div class="widget ltn__tagcloud-widget d-none">
                        <h4 class="ltn__widget-title ltn__widget-title-border">Popular Tags</h4>
                        <ul>
                            <li><a href="#">Popular</a></li>
                            <li><a href="#">desgin</a></li>
                            <li><a href="#">ux</a></li>
                            <li><a href="#">usability</a></li>
                            <li><a href="#">develop</a></li>
                            <li><a href="#">icon</a></li>
                            <li><a href="#">Car</a></li>
                            <li><a href="#">Service</a></li>
                            <li><a href="#">Repairs</a></li>
                            <li><a href="#">Auto Parts</a></li>
                            <li><a href="#">Oil</a></li>
                            <li><a href="#">Dealer</a></li>
                            <li><a href="#">Oil Change</a></li>
                            <li><a href="#">Body Color</a></li>
                        </ul>
                    </div>
                    <!-- Size Widget -->
                    <div class="widget ltn__tagcloud-widget ltn__size-widget d-none">
                        <h4 class="ltn__widget-title ltn__widget-title-border">Product Size</h4>
                        <ul>
                            <li><a href="#">S</a></li>
                            <li><a href="#">M</a></li>
                            <li><a href="#">L</a></li>
                            <li><a href="#">XL</a></li>
                            <li><a href="#">XXL</a></li>
                        </ul>
                    </div>
                    <!-- Color Widget -->
                    <div class="widget ltn__color-widget d-none">
                        <h4 class="ltn__widget-title ltn__widget-title-border">Product Color</h4>
                        <ul>
                            <li class="black"><a href="#"></a></li>
                            <li class="white"><a href="#"></a></li>
                            <li class="red"><a href="#"></a></li>
                            <li class="silver"><a href="#"></a></li>
                            <li class="gray"><a href="#"></a></li>
                            <li class="maroon"><a href="#"></a></li>
                            <li class="yellow"><a href="#"></a></li>
                            <li class="olive"><a href="#"></a></li>
                            <li class="lime"><a href="#"></a></li>
                            <li class="green"><a href="#"></a></li>
                            <li class="aqua"><a href="#"></a></li>
                            <li class="teal"><a href="#"></a></li>
                            <li class="blue"><a href="#"></a></li>
                            <li class="navy"><a href="#"></a></li>
                            <li class="fuchsia"><a href="#"></a></li>
                            <li class="purple"><a href="#"></a></li>
                            <li class="pink"><a href="#"></a></li>
                            <li class="nude"><a href="#"></a></li>
                            <li class="orange"><a href="#"></a></li>

                            <li><a href="#" class="orange"></a></li>
                            <li><a href="#" class="orange"></a></li>
                        </ul>
                    </div>
                    <!-- Banner Widget -->
                    <div class="widget ltn__banner-widget d-none">
                        <a href="shop.html"><img src="img/banner/banner-2.jpg" alt="#"></a>
                    </div>

                </aside>
            </div>
        </div>
    </div>
</div>
<!-- PRODUCT DETAILS AREA END -->
<!-- MODAL AREA START (Quick View Modal) -->
<div class="ltn__modal-area ltn__quick-view-modal-area">
    <div class="modal fade" id="modal-ads" tabindex="-1">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                        <!-- <i class="fas fa-times"></i> -->
                    </button>
                </div>
                <div class="modal-body">
                    <div class="ltn__quick-view-modal-inner">
                        <div class="modal-product-item">
                            <div class="row">
                                <div class="col-lg-6 col-12">
                                    <div class="modal-product-img">
                                        <img src="~/Content/assets/img/product/4.png" alt="#">
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="modal-product-info">
                                        <h3><a href="product-details.html" id="ads-title">3 Rooms Manhattan</a></h3>
                                        <div class="product-price">
                                            <span id="ads-price">$34,900</span> <span id="ads-unitprice"></span>
                                        </div>
                                        <hr>
                                        <div class="modal-product-brief">
                                            <p id="ads-description">Description</p>
                                        </div>
                                        <hr>
                                        <div class="ltn__social-media">
                                            <ul>
                                                <li>Share:</li>
                                                <li><a href="#" title="Facebook"><i class="fab fa-facebook-f"></i></a></li>
                                                <li><a href="#" title="Twitter"><i class="fab fa-twitter"></i></a></li>
                                                <li><a href="#" title="Linkedin"><i class="fab fa-linkedin"></i></a></li>
                                                <li><a href="#" title="Instagram"><i class="fab fa-instagram"></i></a></li>

                                            </ul>
                                        </div>
                                        <label class="float-right mb-0"><a class="text-decoration" href="product-details.html" id="viewDetail"><small>View Details</small></a></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- MODAL AREA END -->

@section scripts {
    <script>

        var catId = 0
        var countryId = 0
        var sortBy
        var strPrice
        var startDate
        var endDate
        var page = 1

        $(function () {
            var url_string = $(location).attr("href");

            var url = new URL(url_string);
            if (url.searchParams.get('catId')) {
                var catId = url.searchParams.get("catId");
                var countryId = url.searchParams.get("countryId");

                $("#filter-category").prop('checked', true);
                $("#filter-country").prop('checked', true);
                console.log($("#filter-category").prop('checked', true).val())
            }

            LoadData()
        })

            
        href ="/Admin/Account/_ModalDetailsAccount/"' + item.Id + ' 

        $('.filter-category').on('change', function () {
            if (location.href.includes('?')) {
                history.pushState({}, null, location.href.split('?')[0]);
            }

            $('.filter-category').not(this).prop('checked', false);
            if ($(this).prop("checked") == true) {
                catId = $(this).val()
            } else if ($(this).prop("checked") == false) {
                catId = 0
            }
            LoadData()
        });

        $('.filter-country').on('change', function () {
            if (location.href.includes('?')) {
                history.pushState({}, null, location.href.split('?')[0]);
            }

            $('.filter-country').not(this).prop('checked', false);
            if ($(this).prop("checked") == true) {
                countryId = $(this).val()
            } else if ($(this).prop("checked") == false) {
                countryId = 0
            }
            LoadData()
        });

        $('.filter-price').on('change', function () {
            if (location.href.includes('?')) {
                history.pushState({}, null, location.href.split('?')[0]);
            }

            $('.filter-price').not(this).prop('checked', false);
            if ($(this).prop("checked") == true) {
                strPrice = $(this).val()
            } else if ($(this).prop("checked") == false) {
                strPrice = ""
            }
            LoadData()
        });

        $('#filter-sort').change(function () {
            sortBy = $("#filter-sort").val();
            LoadData()
        });

        $("#btnFilter-date").click(function () {
            startDate = $("#startDate").val().toString()
            endDate = $("#endDate").val().toString()
            LoadData()
        })

        function LoadData() {
            $.ajax({
                type: "GET",
                url: "/Rent/LoadAds",
                data: {
                    catId: catId,
                    countryId: countryId,
                    sortBy: sortBy,
                    strPrice: strPrice,
                    startDate: startDate,
                    endDate: endDate,
                    page: page
                },
                success: function (res) {
                    $("#content-data").html(res)
                    var count = $("#count-ads").val()
                    $("#result-total-ads").html("(" + count + " results)")
                }
            })
        }

        function GetAds(id) {
            $.ajax({
                type: "GET",
                url: "/Sell/GetAds/" + id,
                success: function (ads) {
                    $("#ads-title").html(ads.Title)
                    $("#ads-title").attr("href", "/Rent/AdsDetail/" + id)
                    $("#viewDetail").attr("href", "/Rent/AdsDetail/" + id)
                    $("#ads-price").html(ads.Price)
                    $("#ads-unitprice").html(ads.UnitPrice)
                    $("#ads-description").html(ads.Description)
                }
            })
        }

        function Paginate(index) {
            page = index
            LoadData()
        }
    </script>
}